<div class="p-8 bg-gray-100 min-h-screen">
  <h1 class="text-2xl font-bold mb-6">Financial Dashboard</h1>

  <div class="flex gap-4 mb-8 bg-white p-4 rounded shadow">
    <input type="file" (change)="onFileUpload($event)" class="border p-2" accept=".csv, .xlsx, .xls, .ods" />
    
    <button (click)="fetchData()" class="bg-blue-600 text-white px-4 py-2 rounded hover:bg-blue-700">Refresh Data</button>
  </div>

  <div *ngIf="data.length === 0" class="text-center p-8 text-gray-500">
    No data found. Upload a file to get started.
  </div>

  <div *ngFor="let group of groupedData" class="mb-8 bg-white rounded shadow overflow-hidden">
    <div class="bg-gray-100 p-4 border-b">
      <h2 class="text-xl font-bold text-gray-800">{{ group.year }}</h2>
    </div>
    
    <div class="overflow-x-auto">
      <table class="w-full text-left border-collapse">
        <thead>
          <tr class="bg-gray-50">
            <th class="p-4 border min-w-[150px]">Metric</th>
            <th *ngFor="let d of group.items" class="p-4 border whitespace-nowrap text-center">
              {{d.month}}
            </th>
          </tr>
        </thead>
        <tbody>
          <tr>
            <td class="p-4 border font-bold">Spends</td>
            <td *ngFor="let d of group.items" class="p-4 border text-center">₹{{d.spent | number:'1.0-0'}}</td>
          </tr>
          <tr>
            <td class="p-4 border font-bold">Web Revenue</td>
            <td *ngFor="let d of group.items" class="p-4 border text-center">₹{{d.revenue | number:'1.0-0'}}</td>
          </tr>
          <tr>
            <td class="p-4 border font-bold">Web Return</td>
            <td *ngFor="let d of group.items" class="p-4 border text-center">₹{{d.return | number:'1.0-0'}}</td>
          </tr>
          <tr class="bg-blue-50">
            <td class="p-4 border font-bold text-blue-800">Difference (Return - Rev)</td>
            <td *ngFor="let d of group.items" class="p-4 border font-semibold text-center">{{ getDifference(d) | currency:'INR':'symbol':'1.0-0' }}</td>
          </tr>
          <tr class="bg-green-50">
            <td class="p-4 border font-bold text-green-800">Efficiency (%)</td>
            <td *ngFor="let d of group.items" class="p-4 border font-semibold text-center">{{ getPercentage(d) | number:'1.0-2' }}%</td>
          </tr>
        </tbody>
      </table>
    </div>
  </div>
</div>
